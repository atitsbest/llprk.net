@model Llprk.Web.UI.Models.Order

@{
    ViewBag.Title = "Details";
}

<div class="span12" >
    <fieldset>
        <legend>
            <div class="row clearfix">
            <span class="span3">ORDER #@Html.DisplayFor(m => m.Id)</span>
                @if(!Model.IsPaid) {
                    using (Html.BeginForm("paid", "orders", new { id = Model.Id }, FormMethod.Post, new { @class="span2", style="margin-bottom:0;" })) {
                        <button class="btn btn-small" onclick="return confirm('Are you sure?');">Invoice paid</button>
                    }
                }
                @if(!Model.IsShipped) {
                    using (Html.BeginForm("shipped", "orders", new { id = Model.Id }, FormMethod.Post, new { @class = "span2", style="margin-bottom:0;" })) {
                        <button class="btn btn-small" onclick="return confirm('Are you sure?');">Order shipped</button>
                    }
                }
            <span class="pull-right">@Model.CreatedAt.ToShortDateString()</span>
            </div>
        </legend>
            
        @Html.HiddenFor(m => m.Id)

        @if(Model.IsPaid) {
            <img src="@Url.Content("~/images/paid_stamp.png")" style="height:120px;position:absolute;right:100px;opacity:.5;" />
        }
        @if(Model.IsShipped) {
            <img src="@Url.Content("~/images/delivered_stamp.png")" style="position:absolute;right:0px;margin-top:15px;opacity:.5;" />
        }

        <div class="row">
            <div class="span6">
                <h5>
                    @Html.DisplayFor(model => model.Salutation)<br />
                    @Html.DisplayFor(model => model.Firstname)
                    @Html.DisplayFor(model => model.Name)
                </h5>

                @Html.DisplayFor(model => model.Address1)<br />

                @Html.DisplayFor(model => model.Address2)<br />
                @Html.DisplayFor(model => model.Zip)&nbsp;-&nbsp;@Html.DisplayFor(model => model.City)<br />
                @Html.DisplayFor(model => model.CountryCode)
                @Html.DisplayFor(model => model.Email)

            </div>

            <div class="offset3 span3" style="text-align:right;">
            </div>
        </div>
        <br />
        <div class="row">
            <div class="span6">
                <h5>DETAILS</h5>
                <div class="display-label">
                    <table class="table">
                        @foreach (var ol in Model.OrderLines) {
                            <tr>
                                <td>
                                    @Html.ActionLink(@ol.Product.Name, "details", "products", new { id = @ol.ProductId }, null)
                                </td>
                                <td>
                                    @ol.Qty
                                </td>
                                <td style="text-align:right;">
                                   @ol.Product.Price.ToString("c") 
                                </td>
                            </tr>
                        }
                        <tfoot>
                            <tr>
                                <td colspan="2" style="text-align:right;">
                                    Subtotal
                                </td>
                                <td style="text-align:right;">
                                    @Model.TotalPrice.ToString("c")
                                </td>
                            </tr>
                            <tr>
                                <td colspan="2" style="text-align:right;">
                                    Shipping
                                </td>
                                <td style="text-align:right;">
                                    ???
                                </td>
                            </tr>
                            <tr>
                                <td colspan="2" style="text-align:right;font-weight:bold;">
                                    Total
                                </td>
                                <td style="text-align:right;font-weight:bold;">
                                    @Model.TotalPrice.ToString("c")
                                </td>
                            </tr>
                        </tfoot>
                    </table>
                </div>
            </div>
        </div>


        <div class="row form-actions">
            @using(Html.BeginForm("comment", "orders", new {id=Model.Id})) {
                <div class="span6">
                    <h5>NOTES</h5>
                    @Html.TextAreaFor(m => m.Comment, new { @class = "span6", rows = "5" })
                </div>
                <div class="span6">
                    <input type="submit" value="Speichern" class="btn btn-small btn-success" />
                    @Html.ActionLink("Back to List", "Index", null, new { @class = "btn btn-small" })
                </div>
            }
        </div>    

    </fieldset>
</div>
